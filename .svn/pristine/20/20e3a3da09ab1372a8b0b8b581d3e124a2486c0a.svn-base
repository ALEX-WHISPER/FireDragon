{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\FireDragon\\net/assets\\scripts\\FireDragon\\net\\request.js"],"names":["net","require","util","ServerType","md5","GatewayHeartbeat","msg","MakeMsg","free","SendMsg","PS","RoomId","FastRegister","reg_type","Login","name","password","sLicensekey","console","log","game_id","GameId","account","password_md5","PwdMD5","authcode","deviceInfo","getDeviceInfo","platform","getPlatFrom","confirmAuthCode","aAuthCode","QueryArenaReq","QueryUserTableReq","MC","ArenaId","EnterArenaReq","arenaId","gameVersion","cur_version","curVersion","min_version","minVersion","max_version","maxVersion","HallEnterRoomReq","HallSitInGSReq","uid","roomId","user_dbid","GS","CertificaitonLoginReq","HallGsReadyReq","RequestAttack","score","ratio","type","Score","Ratio","Type","IsHighMode","GD","RequestAdditional","id","data","Id","Data","RequestGameServerTime","bNewTime","UserLogoutReq","ticketExchangeGoldReq","userid","ticket","callBack","sAddress","handle","SECURITY_KEY","sign","url","cc","js","formatStr","hex_md5","sendRequest","xhr","XMLHttpRequest","onreadystatechange","readyState","status","result","responseText","open","send"],"mappings":"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","file":"request.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\FireDragon\\net","sourcesContent":["var net = require(\"net\")\nvar util  = require('util')\nvar ServerType = net.ServerType\n// var UserManager = require('UserManager');    //  EASON COMMENT\n// const EventManager=require('EventManager');  //  EASON COMMENT\nvar md5 = require('MD5') \nnet.GatewayHeartbeat = function(){\n    var msg = net.MakeMsg(\"GatewayHeartbeat\")\n    msg.free = 1;\n    net.SendMsg(msg, ServerType.PS, net.RoomId, false)\n}\n\nnet.FastRegister = function(){ \n    var msg = net.MakeMsg(\"FastRegisterRequest\") \n    msg.reg_type = 4;\n    net.SendMsg(msg,ServerType.PS)\n}\n\nnet.Login = function(name, password, sLicensekey){ \n    var msg = net.MakeMsg(\"ThreeWayLoginWithDeviceRequest\")\n    if (msg === null) {\n        console.log(\"msg is null\");\n        return;\n    }\n    msg.game_id= net.GameId\n    msg.account = name                     // 帐号名\n\n    msg.password_md5 = util.PwdMD5(password)            // 密码的MD5结果\n\n    msg.authcode = \"\"              // 亲朋登陆凭证 \n     \n    if(sLicensekey){\n        msg.authcode = sLicensekey\n    }  \n//   msg.deviceInfo =\"\";\n     msg.deviceInfo = util.getDeviceInfo()+''     //客户端设备信息\n    // console.error('获取登录设备信息',msg.deviceInfo) \n    \n    msg.platform = util.getPlatFrom();\n    net.SendMsg(msg, ServerType.PS)\n}\n\n//登录成功确认绑定\nnet.confirmAuthCode=function(aAuthCode){  \n      var msg = net.MakeMsg(\"AuthCodeConfirm\");\n      msg.authcode = aAuthCode;\n\t//   msg.userID = UserManager.User.id;  //  EASON COMMENT\n      net.SendMsg(msg, ServerType.PS);\n} \n\n//房间查询\nnet.QueryArenaReq = function(){ \n    var msg = net.MakeMsg(\"QueryArenaRequest\")\n    msg.game_id = net.GameId\n    net.SendMsg(msg, ServerType.PS)\n}  \n\nnet.QueryUserTableReq = function(){\n    console.log(\"net.QueryUserTableReq\")\n    var  msg = net.MakeMsg(\"QueryUserTableReq\")\n    // msg.user_id = UserManager.Self().id  //  EASON COMMENT\n    net.SendMsg(msg,ServerType.MC,net.ArenaId)\n}\n\n//房间查询\nnet.QueryArenaReq = function(){ \n    var msg = net.MakeMsg(\"QueryArenaRequest\")\n    msg.game_id = net.GameId\n    net.SendMsg(msg, ServerType.PS)\n}\n\n//查询到arena后，点击发送此请求\nnet.EnterArenaReq = function (arenaId, gameVersion) {  \n    var msg = net.MakeMsg(\"UserEnterMCReq\");\n    msg.cur_version = gameVersion.curVersion;\n    msg.min_version = gameVersion.minVersion;\n    msg.max_version = gameVersion.maxVersion;\n    net.SendMsg(msg, ServerType.MC, arenaId);\n};\n\n\n// net.EnterCustomTableReq = function(sn,areId){\n//     var  msg = net.MakeMsg(\"EnterCustomTableReq\")\n//     msg.sn = sn\n//     msg.baofang_table_id = 0\n//     msg.baofang_id = 0\n//     var bfDefines = require(\"BaofangDefines\")\n//     if(bfDefines.baofangNum){\n//         msg.baofang_id = bfDefines.baofangNum\n//     }\n//     if(bfDefines.baofangDesk){\n//         msg.baofang_table_id = bfDefines.baofangDesk\n//     } \n//     net.SendMsg(msg,ServerType.MC,areId)\n// }\n\nnet.HallEnterRoomReq= function(){\n    var msg = net.MakeMsg(\"HallEnterRoomReq\");\n    net.SendMsg(msg,ServerType.MC,net.ArenaId);\n}\n\n\nnet.HallSitInGSReq = function (uid, roomId) { \n    var msg = net.MakeMsg(\"HallSitInGSReq\");\n    msg.user_dbid = uid;\n    net.SendMsg(msg, ServerType.GS, roomId);\n};\n\n\nnet.CertificaitonLoginReq = function()\n{ \n    var msg = net.MakeMsg(\"CertificaitonLoginReq\")\n    // msg.user_dbid = UserManager.User.id; //  EASON COMMENT\n    // msg.certification =  UserManager.User.certification; //  EASON COMMENT\n    msg.game_id = net.GameId; \n    net.SendMsg(msg, ServerType.PS);\n}\n\n\nnet.HallGsReadyReq = function(){ \n    console.log('kaishile',net.RoomId)\n    var msg = net.MakeMsg(\"HallGsReadyReq\")\n    net.SendMsg(msg, ServerType.GS, net.RoomId) \n}\n\n//击杀怪物调用接口\nnet.RequestAttack = function(score,ratio,type){\n    console.log('房间号',net.RoomId);\n    var msg = net.MakeMsg(\"RequestAttack\")\n    msg.Score = score;\n    msg.Ratio = ratio;\n    msg.Type = type;\n    msg.IsHighMode=false;\n    net.SendMsg(msg, ServerType.GD,net.RoomId);\n} \n\n//保存数据接口\nnet.RequestAdditional=function(id,data){\n    var msg = net.MakeMsg(\"RequestAdditional\")\n    msg.Id = id;\n    msg.Data = data; \n    net.SendMsg(msg, ServerType.GD,net.RoomId);\n}\n\n//获取服务器时间\nnet.RequestGameServerTime=function(){\n    var msg = net.MakeMsg(\"RequestGameServerTime\");\n    msg.bNewTime = true;  \n    net.SendMsg(msg, ServerType.GD,net.RoomId);\n}\n\n//退出登录\nnet.UserLogoutReq=function(){\n    var msg = net.MakeMsg(\"UserLogoutReq\");\n    // msg.user_dbid = UserManager.User.id; //  EASON COMMENT\n\t// msg.certification = UserManager.User.certification;  //  EASON COMMENT\n\tmsg.game_id = net.GameId;\n\tmsg.platform = 0;\n    net.SendMsg(msg, ServerType.PS,net.RoomId);\n}\n\n\n\n// //进入房间\n// net.HallEnterRoomReq = function (id) {\n//     var msg = net.MakeMsg(\"HallEnterRoomReq\");\n//     net.SendMsg(msg, ServerType.MC, id);\n// };  \n\n//点劵兑换\nnet.ticketExchangeGoldReq=function(userid, ticket,callBack){ \n     let sAddress='http://mapi.qpgame.com/Services/api.ashx'; \n     let handle = \"userticketchargecoin\";\n     let SECURITY_KEY = \"E8FE168AD73Fqp*s$yGAME\";  \n     let sign=handle+userid+ticket+net.GameId+ 0 +SECURITY_KEY;  \n     let url = cc.js.formatStr(\"%s?handle=%s&uid=%d&gameid=%s&ticket=%s&datatype=json&sign=%s&exchangetype=0\",\n          sAddress, handle, userid, net.GameId, ticket, md5.hex_md5(sign));  \n     net.sendRequest(url,callBack);     \n} \n\nnet.sendRequest=function(url,callBack){\n            var xhr = new XMLHttpRequest();\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\n                    var result = xhr.responseText;  \n                    if(callBack)\n                       callBack(result);\n                }\n            };\n            xhr.open(\"GET\", url, true);\n            xhr.send();\n}\n\n"]}