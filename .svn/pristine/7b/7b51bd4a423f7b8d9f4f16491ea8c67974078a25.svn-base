{"version":3,"sources":["wxUserInfoDisplay.js"],"names":["cc","Class","extends","Component","properties","avatar_EnterRoom","Node","nickName_EnterRoom","enableGetUserInfo","self","button","wx","createUserInfoButton","type","text","style","left","top","width","height","lineHeight","backgroundColor","color","textAlign","fontSize","borderRadius","onTap","res","console","log","getUserInfo","withCredentials","success","userInfo","nickName","language","avatarUrl","gender","country","province","city","setUserInfo","_picUrl","loader","load","url","err_","tex_","error","Texture2D","_frame","SpriteFrame","getComponent","Sprite","spriteFrame","Label","string"],"mappings":";;;;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,0BAAkBL,GAAGM,IADb;AAERC,4BAAoBP,GAAGM;AAFf,KAHP;;AAQLE,uBAAmB,6BAAW;AAC1B,YAAIC,OAAO,IAAX;;AAEA,YAAIC,SAASC,GAAGC,oBAAH,CAAwB;AACjCC,kBAAM,MAD2B;AAEjCC,kBAAM,QAF2B;AAGjCC,mBAAO;AACHC,sBAAM,EADH;AAEHC,qBAAK,EAFF;AAGHC,uBAAO,GAHJ;AAIHC,wBAAQ,EAJL;AAKHC,4BAAY,EALT;AAMHC,iCAAiB,SANd;AAOHC,uBAAO,SAPJ;AAQHC,2BAAW,QARR;AASHC,0BAAU,EATP;AAUHC,8BAAc;AAVX;AAH0B,SAAxB,CAAb;;AAiBAf,eAAOgB,KAAP,CAAa,UAACC,GAAD,EAAS;AAClBC,oBAAQC,GAAR,CAAY,YAAZ;AACApB,iBAAKqB,WAAL;AACH,SAHD;AAIH,KAhCI;;AAkCLA,iBAAa,uBAAW;AACpB,YAAIrB,OAAO,IAAX;;AAEAE,WAAGmB,WAAH,CAAe;AACXC,6BAAiB,IADN;;AAGXC,qBAAS,iBAASL,GAAT,EAAc;AACnBlB,qBAAKwB,QAAL,GAAgBN,IAAIM,QAApB;AACA,oBAAIC,WAAWzB,KAAKwB,QAAL,CAAcC,QAA7B;AACA,oBAAIC,WAAW1B,KAAKwB,QAAL,CAAcE,QAA7B;AACA,oBAAIC,YAAY3B,KAAKwB,QAAL,CAAcG,SAA9B;AACA,oBAAIC,SAAS5B,KAAKwB,QAAL,CAAcI,MAA3B;AACA,oBAAIC,UAAU7B,KAAKwB,QAAL,CAAcK,OAA5B;AACA,oBAAIC,WAAW9B,KAAKwB,QAAL,CAAcM,QAA7B;AACA,oBAAIC,OAAO/B,KAAKwB,QAAL,CAAcO,IAAzB;;AAEA/B,qBAAKgC,WAAL;;AAEAb,wBAAQC,GAAR,CAAY,eAAeK,QAA3B;AACAN,wBAAQC,GAAR,CAAY,eAAeU,QAA3B;AACAX,wBAAQC,GAAR,CAAY,eAAeM,QAA3B;AACAP,wBAAQC,GAAR,CAAY,gBAAgBO,SAA5B;AACH;AAnBU,SAAf;AAqBH,KA1DI;;AA4DLK,iBAAa,uBAAW;AACpB;AACA,YAAIC,UAAU,KAAKT,QAAL,CAAcG,SAA5B;AACA,YAAIF,WAAW,KAAKD,QAAL,CAAcC,QAA7B;AACA,YAAIzB,OAAO,IAAX;;AAEAT,WAAG2C,MAAH,CAAUC,IAAV,CAAe,EAACC,KAAIH,OAAL,EAAc7B,MAAK,KAAnB,EAAf,EAAyC,UAAUiC,IAAV,EAAgBC,IAAhB,EAAsB;AACvD,gBAAID,IAAJ,EAAU;AACV9C,mBAAGgD,KAAH,CAAS,uCAAT,EAAkDF,IAAlD,EAAwD,SAAxD,EAAmEJ,OAAnE;AACA;AACH;AACD,gBAAI,EAAEK,gBAAgB/C,GAAGiD,SAArB,CAAJ,EAAqC;AACjCjD,mBAAGgD,KAAH,CAAS,yDAAT,SAA2ED,IAA3E,yCAA2EA,IAA3E;AACA;AACH;AACDA,iBAAK7B,KAAL,GAAa6B,KAAK5B,MAAL,GAAc,GAA3B;AACA,gBAAI+B,SAAS,IAAIlD,GAAGmD,WAAP,CAAmBJ,IAAnB,CAAb;AACAtC,iBAAKJ,gBAAL,CAAsB+C,YAAtB,CAAmCpD,GAAGqD,MAAtC,EAA8CC,WAA9C,GAA4DJ,MAA5D;AACH,SAZD;;AAcA;AACAzC,aAAKF,kBAAL,CAAwB6C,YAAxB,CAAqCpD,GAAGuD,KAAxC,EAA+CC,MAA/C,GAAwDtB,QAAxD;AACH;AAlFI,CAAT","file":"wxUserInfoDisplay.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\FireDragon\\EnterRoom","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        avatar_EnterRoom: cc.Node,\r\n        nickName_EnterRoom: cc.Node\r\n    },\r\n\r\n    enableGetUserInfo: function() {\r\n        var self = this;\r\n        \r\n        var button = wx.createUserInfoButton({\r\n            type: 'text',\r\n            text: '获取用户信息',\r\n            style: {\r\n                left: 10,\r\n                top: 76,\r\n                width: 200,\r\n                height: 40,\r\n                lineHeight: 40,\r\n                backgroundColor: '#ffffff',\r\n                color: '#ffffff',\r\n                textAlign: 'center',\r\n                fontSize: 16,\r\n                borderRadius: 4\r\n            }\r\n        });\r\n\r\n        button.onTap((res) => {\r\n            console.log(\"tap button\");\r\n            self.getUserInfo();\r\n        })\r\n    },\r\n\r\n    getUserInfo: function() {\r\n        var self = this;\r\n\r\n        wx.getUserInfo({\r\n            withCredentials: true,\r\n\r\n            success: function(res) {\r\n                self.userInfo = res.userInfo;\r\n                var nickName = self.userInfo.nickName;\r\n                var language = self.userInfo.language;\r\n                var avatarUrl = self.userInfo.avatarUrl;\r\n                var gender = self.userInfo.gender;\r\n                var country = self.userInfo.country;\r\n                var province = self.userInfo.province;\r\n                var city = self.userInfo.city;\r\n\r\n                self.setUserInfo();\r\n\r\n                console.log(\"nickName: \" + nickName);\r\n                console.log(\"province: \" + province);\r\n                console.log(\"language: \" + language);\r\n                console.log(\"avatarUrl: \" + avatarUrl);        \r\n            }\r\n        });\r\n    },\r\n\r\n    setUserInfo: function() {\r\n        //  set avatar\r\n        var _picUrl = this.userInfo.avatarUrl;\r\n        var nickName = this.userInfo.nickName;\r\n        var self = this;\r\n\r\n        cc.loader.load({url:_picUrl, type:\"png\"},function (err_, tex_) {\r\n                if (err_) {\r\n                cc.error(\"ResMgr.loadImage load  image failed: \", err_, \", url: \", _picUrl);\r\n                return;\r\n            }\r\n            if (!(tex_ instanceof cc.Texture2D)) {\r\n                cc.error(\"ResMgr.loadImage jpg image is not instance of Texture2D\", typeof(tex_));\r\n                return;\r\n            }\r\n            tex_.width = tex_.height = 128;\r\n            var _frame = new cc.SpriteFrame(tex_);\r\n            self.avatar_EnterRoom.getComponent(cc.Sprite).spriteFrame = _frame;\r\n        });\r\n\r\n        //  set nickName\r\n        self.nickName_EnterRoom.getComponent(cc.Label).string = nickName;\r\n    }\r\n});\r\n"]}